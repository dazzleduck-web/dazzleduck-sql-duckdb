# name: test/sql/dd_read_arrow.test
# description: test dd_read_arrow table function
# group: [sql]

# Require statement will ensure this test is run with this extension loaded
require dazzleduck

# Clear default HTTP skip behavior for parameter validation tests
# These tests fail at parameter validation, before any HTTP calls
set ignore_error_messages

# Test error: missing both source_table and sql parameters
statement error
SELECT * FROM dd_read_arrow('http://localhost:8081');
----
dd_read_arrow requires either 'source_table' or 'sql' parameter

# Test error: providing both source_table and sql parameters
statement error
SELECT * FROM dd_read_arrow('http://localhost:8081', source_table := 'test', sql := 'SELECT 1');
----
dd_read_arrow accepts either 'source_table' or 'sql' parameter, not both

# Test error: invalid named parameter
statement error
SELECT * FROM dd_read_arrow('http://localhost:8081', sql := 'SELECT 1', invalid_param := 'test');
----
Invalid named parameter "invalid_param" for function dd_read_arrow

# Test error: split still requires either source_table or sql
statement error
SELECT * FROM dd_read_arrow('http://localhost:8081', split := true);
----
dd_read_arrow requires either 'source_table' or 'sql' parameter

# Test error: split still requires either source_table or sql (with split=false)
statement error
SELECT * FROM dd_read_arrow('http://localhost:8081', split := false);
----
dd_read_arrow requires either 'source_table' or 'sql' parameter
